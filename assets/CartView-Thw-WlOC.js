import{a as i}from"./axios-G2rPRu76.js";import{_ as y,c as n,b as t,F as f,g as v,h,v as g,t as _,d as x,w,r as C,o as c,e as k}from"./index-fZ5w6lkA.js";var V={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_NAME:"qoo",BASE_URL:"/Vue-2023-week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:p,VITE_NAME:u}=V,L={data(){return{cart:{},status:{cartQtyLoading:""},coupon_code:""}},methods:{getCart(){const a=`${p}/api/${u}/cart`;i.get(a).then(s=>{console.log("cart",s.data.data),this.cart=s.data.data}).catch(s=>{console.log(s),alert(s.response.data.message)})},adjustCartQty(a,s=1){const e=`${p}/api/${u}/cart/${a.id}`,b={product_id:a.product_id,qty:s};console.log(b),this.status.cartQtyLoading=a.id,i.put(e,{data:b}).then(d=>{console.log(d.data),this.status.cartQtyLoading="",this.getCart()}).catch(d=>{console.log(d.response.data.message)})},removeCartItem(a){const s=`${p}/api/${u}/cart/${a}`;this.status.cartQtyLoading=a,i.delete(s).then(e=>{console.log(e.data),this.status.cartQtyLoading="",alert(e.data.message),this.getCart()}).catch(e=>{console.log(e.data.message),alert(e.response.data.message)})},addCoupon(){const a=`${p}/api/${u}/coupon`,s={code:this.coupon_code};i.post(a,{data:{coupon:s}}).then(e=>{console.log(e.data),this.getCart()}).catch(e=>{console.log(e.response.data.message),alert("優惠卷代碼輸入錯誤，請再次嘗試")})}},mounted(){this.getCart()}},E={class:"container mb-6"},$={class:"mt-3"},q=t("h3",{class:"mt-3 mb-4"},"購物車",-1),Q={class:"row"},T={class:"col-md-8"},N={class:"table"},R=t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"border-0 ps-0"},"商品"),t("th",{scope:"col",class:"border-0"},"數量"),t("th",{scope:"col",class:"border-0"},"小計"),t("th",{scope:"col",class:"border-0"})])],-1),U={class:"border-bottom border-top"},I={scope:"row",class:"border-0 px-0 font-weight-normal py-4"},j=["src"],D={class:"mb-0 fw-bold ms-3 d-inline-block"},A={class:"border-0 align-middle",style:{"max-width":"160px"}},B={class:"input-group pe-5"},M={class:"input-group-prepend"},S=["onClick","disabled"],F=t("i",{class:"bi bi-dash"},null,-1),O=[F],P=["onClick"],z=t("i",{class:"bi bi-trash3-fill"},null,-1),G=[z],H=["onUpdate:modelValue","disabled"],J={class:"input-group-append"},K=["onClick"],W=t("i",{class:"bi bi-plus"},null,-1),X=[W],Y={class:"border-0 align-middle"},Z={class:"mb-0 ms-auto"},tt=t("td",{class:"border-0 align-middle"},[t("i",{class:"fas fa-times"})],-1),ot={class:"input-group w-50 mb-3"},st={class:"input-group-append"},et=t("i",{class:"bi bi-send"},null,-1),at=[et],dt={class:"col-md-4"},nt={class:"border p-4 mb-4"},ct=t("h4",{class:"fw-bold mb-4"},"訂單金額",-1),lt={class:"table text-muted border-bottom"},rt=t("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"},"訂單金額",-1),it={class:"text-end border-0 px-0 pt-4"},_t=t("tr",null,[t("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"},"付款方式"),t("td",{class:"text-end border-0 px-0 pt-0 pb-4"},"ApplePay")],-1),pt={class:"d-flex justify-content-between mt-4"},ut=t("p",{class:"mb-0 h4 fw-bold"},"總計",-1),bt={class:"mb-0 h4 fw-bold"};function ht(a,s,e,b,d,l){const m=C("RouterLink");return c(),n("div",E,[t("div",$,[q,t("div",Q,[t("div",T,[t("table",N,[R,(c(!0),n(f,null,v(d.cart.carts,o=>(c(),n("tbody",{key:o.id},[t("tr",U,[t("th",I,[t("img",{src:o.product.imageUrl,alt:"",style:{width:"72px",height:"72px","object-fit":"cover"}},null,8,j),t("p",D,_(o.product.title),1)]),t("td",A,[t("div",B,[t("div",M,[o.qty>1?(c(),n("button",{key:0,class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon1",onClick:r=>{o.qty--,l.adjustCartQty(o,o.qty)},disabled:o.qty===1},O,8,S)):(c(),n("button",{key:1,type:"button",class:"btn btn-outline-danger",onClick:r=>l.removeCartItem(o.id)},G,8,P))]),h(t("input",{type:"text",class:"form-control border-0 text-center my-auto shadow-none",placeholder:"","aria-label":"Example text with button addon","aria-describedby":"button-addon1","onUpdate:modelValue":r=>o.qty=r,disabled:o.id===d.status.cartQtyLoading,readonly:""},null,8,H),[[g,o.qty]]),t("div",J,[t("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon2",onClick:r=>{o.qty++,l.adjustCartQty(o,o.qty)}},X,8,K)])])]),t("td",Y,[t("p",Z,"NT$"+_(o.total),1)]),tt])]))),128))]),t("div",ot,[h(t("input",{type:"text",class:"form-control rounded-0 border-bottom border-top-0 border-start-0 border-end-0 shadow-none","onUpdate:modelValue":s[0]||(s[0]=o=>d.coupon_code=o),placeholder:"請輸入優惠碼"},null,512),[[g,d.coupon_code]]),t("div",st,[t("button",{class:"btn btn-outline-dark border-bottom border-top-0 border-start-0 border-end-0 rounded-0",type:"button",onClick:s[1]||(s[1]=o=>l.addCoupon(d.coupon_code))},at)])])]),t("div",dt,[t("div",nt,[ct,t("table",lt,[t("tbody",null,[t("tr",null,[rt,t("td",it,"NT$"+_(d.cart.total),1)]),_t])]),t("div",pt,[ut,t("p",bt,"NT$"+_(d.cart.final_total),1)]),x(m,{to:"/checkout",class:"btn btn-dark w-100 mt-4"},{default:w(()=>[k("結帳")]),_:1})])])])])])}const yt=y(L,[["render",ht]]);export{yt as default};
