import{a as _}from"./axios-G2rPRu76.js";import{_ as y,c,b as t,F as f,h as v,i as h,v as m,t as p,d as x,w,r as C,o as l,e as k}from"./index-4BTZusAp.js";var V={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_NAME:"qoo",BASE_URL:"/Vue-2023-week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:u,VITE_NAME:b}=V,L={data(){return{cart:{},status:{cartQtyLoading:""},coupon_code:""}},methods:{getCart(){const e=`${u}/api/${b}/cart`;_.get(e).then(s=>{console.log("cart",s.data.data),this.cart=s.data.data}).catch(s=>{console.log(s),alert(s.response.data.message)})},adjustCartQty(e,s=1){const d=`${u}/api/${b}/cart/${e.id}`,n={product_id:e.product_id,qty:s};console.log(n),this.status.cartQtyLoading=e.id,_.put(d,{data:n}).then(a=>{console.log(a.data),this.status.cartQtyLoading="",this.getCart()}).catch(a=>{console.log(a.response.data.message)})},removeCartItem(e){const s=`${u}/api/${b}/cart/${e}`;this.status.cartQtyLoading=e,_.delete(s).then(d=>{console.log(d.data),this.status.cartQtyLoading="",alert(d.data.message),this.getCart()}).catch(d=>{console.log(d.data.message),alert(d.response.data.message)})},addCoupon(e){const s=`${u}/api/${b}/coupon`,d={code:e};_.post(s,{data:d}).then(n=>{console.log(n.data),this.getCart()}).catch(n=>{console.log(n.response.data.message),alert("優惠卷代碼輸入錯誤，請再次嘗試")})}},mounted(){this.getCart()}},E={class:"container mb-6"},$={class:"mt-3"},q=t("h3",{class:"mt-3 mb-4"},"購物車",-1),Q={class:"row"},T={class:"col-md-8"},N={class:"table"},R=t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"border-0 ps-0"},"商品"),t("th",{scope:"col",class:"border-0"},"數量"),t("th",{scope:"col",class:"border-0"},"小計"),t("th",{scope:"col",class:"border-0"})])],-1),U={class:"border-bottom border-top"},I={scope:"row",class:"border-0 px-0 font-weight-normal py-4"},j=["src"],D={class:"mb-0 fw-bold ms-3 d-inline-block"},A={class:"border-0 align-middle",style:{"max-width":"160px"}},B={class:"input-group pe-5"},M={class:"input-group-prepend"},S=["onClick","disabled"],F=t("i",{class:"bi bi-dash"},null,-1),O=[F],P=["onClick"],z=t("i",{class:"bi bi-trash3-fill"},null,-1),G=[z],H=["onUpdate:modelValue","disabled"],J={class:"input-group-append"},K=["onClick"],W=t("i",{class:"bi bi-plus"},null,-1),X=[W],Y={class:"border-0 align-middle"},Z={class:"mb-0 ms-auto"},tt=t("td",{class:"border-0 align-middle"},[t("i",{class:"fas fa-times"})],-1),ot={class:"input-group w-50 mb-3"},st={class:"input-group-append"},et=t("i",{class:"bi bi-send"},null,-1),at=[et],dt={class:"col-md-4"},nt={class:"border p-4 mb-4"},ct=t("h4",{class:"fw-bold mb-4"},"訂單金額",-1),lt={class:"table text-muted border-bottom"},rt=t("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"},"訂單金額",-1),it={class:"text-end border-0 px-0 pt-4"},_t=t("tr",null,[t("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"},"付款方式"),t("td",{class:"text-end border-0 px-0 pt-0 pb-4"},"ApplePay")],-1),pt={class:"d-flex justify-content-between mt-4"},ut=t("p",{class:"mb-0 h4 fw-bold"},"總計",-1),bt={class:"mb-0 h4 fw-bold"};function ht(e,s,d,n,a,r){const g=C("RouterLink");return l(),c("div",E,[t("div",$,[q,t("div",Q,[t("div",T,[t("table",N,[R,(l(!0),c(f,null,v(a.cart.carts,o=>(l(),c("tbody",{key:o.id},[t("tr",U,[t("th",I,[t("img",{src:o.product.imageUrl,alt:"",style:{width:"72px",height:"72px","object-fit":"cover"}},null,8,j),t("p",D,p(o.product.title),1)]),t("td",A,[t("div",B,[t("div",M,[o.qty>1?(l(),c("button",{key:0,class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon1",onClick:i=>{o.qty--,r.adjustCartQty(o,o.qty)},disabled:o.qty===1},O,8,S)):(l(),c("button",{key:1,type:"button",class:"btn btn-outline-danger",onClick:i=>r.removeCartItem(o.id)},G,8,P))]),h(t("input",{type:"text",class:"form-control border-0 text-center my-auto shadow-none",placeholder:"","aria-label":"Example text with button addon","aria-describedby":"button-addon1","onUpdate:modelValue":i=>o.qty=i,disabled:o.id===a.status.cartQtyLoading,readonly:""},null,8,H),[[m,o.qty]]),t("div",J,[t("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon2",onClick:i=>{o.qty++,r.adjustCartQty(o,o.qty)}},X,8,K)])])]),t("td",Y,[t("p",Z,"NT$"+p(o.total),1)]),tt])]))),128))]),t("div",ot,[h(t("input",{type:"text",class:"form-control rounded-0 border-bottom border-top-0 border-start-0 border-end-0 shadow-none","onUpdate:modelValue":s[0]||(s[0]=o=>a.coupon_code=o),placeholder:"請輸入優惠碼"},null,512),[[m,a.coupon_code]]),t("div",st,[t("button",{class:"btn btn-outline-dark border-bottom border-top-0 border-start-0 border-end-0 rounded-0",type:"button",onClick:s[1]||(s[1]=o=>r.addCoupon(a.coupon_code))},at)])])]),t("div",dt,[t("div",nt,[ct,t("table",lt,[t("tbody",null,[t("tr",null,[rt,t("td",it,"NT$"+p(a.cart.total),1)]),_t])]),t("div",pt,[ut,t("p",bt,"NT$"+p(a.cart.final_total),1)]),x(g,{to:"/checkout",class:"btn btn-dark w-100 mt-4"},{default:w(()=>[k("結帳")]),_:1})])])])])])}const yt=y(L,[["render",ht]]);export{yt as default};
